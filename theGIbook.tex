\documentclass[10pt,fancyhdr,graybox, envcountchap,oribibl,twoside]{svmono}

\usepackage[UTF8,fontset = my]{ctex}
%\ctexset{fontset = my}

\usepackage[centering,paperwidth=190mm,paperheight=240mm,left=22mm,top=24mm,marginparsep=3mm,marginparwidth=30mm,textwidth=120mm,height=200mm]{geometry}

\renewcommand\_{\textunderscore\allowbreak}

\usepackage{fancyhdr}
\pagestyle{fancy}
%\renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}
\renewcommand{\chaptermark}[1]{\markright{\thechapter.\ #1}{}}
\renewcommand{\sectionmark}[1]{}
\fancyhead[LO]{\rightmark}
\fancyhead[LE,RO]{\thepage}
\fancyhead[RE]{\text{全局光照技术：从离线到实时渲染}}
\fancyfoot[C]{}
\addtolength\headwidth{33mm}

 
 



 
 

%------------------------------------
\usepackage{multicol}
\newcommand{\multicolumnmtc}{2}

\usepackage[tight]{minitoc}
\setcounter{minitocdepth}{1}
\setlength{\mtcindent}{0pt}
\mtcsetpagenumbers{minitoc}{off}
\def\mtctitle{}
\mtcsetformat{minitoc}{tocrightmargin}{2.55em plus 1fil}
\makeatletter
 \let\SV@mtc@verse\mtc@verse
 \let\SV@endmtc@verse\endmtc@verse
 \def\mtc@verse#1{\SV@mtc@verse#1\removelastskip%
 \begin{multicols}{\multicolumnmtc}\raggedcolumns\leavevmode\unskip  \vskip -1.0ex \vskip -1\baselineskip}
 \def\endmtc@verse{\end{multicols}\SV@endmtc@verse}
\makeatother
%------------------------------------


\usepackage[utf8]{inputenc}
\usepackage{tcolorbox}
\usepackage{titlesec} 
\titleformat{\chapter} % command
[block] % shape
{} % format
{\begin{tcolorbox}[height=2.5cm,width=2.5cm,colback=white,boxrule=1.6mm,arc=0mm,valign=center,halign=center] \Huge\thechapter\end{tcolorbox}} % label
{0.0ex} % sep
{
    \raggedright\bfseries\Huge\itshape
} % before-code
[
\vspace{2.5ex}%
] %


%数学符号
\usepackage{amssymb}
%------------------------------------

%\usepackage{mathptmx}        % selects Times Roman as basic font
%\usepackage{helvet}          % selects Helvetica as sans-serif font
%\usepackage{courier}         % selects Courier as typewriter font
%\usepackage{type1cm}        % activate if the above 3 fonts are 
                             % not available on your system

\usepackage{makeidx}         % allows index generation
\usepackage{graphicx}        % standard LaTeX graphics tool
                             % when including figure files
\usepackage{multicol}        % used for the two-column index
\usepackage[bottom]{footmisc}% places footnotes at page bottom

% see the list of further useful packages in the Reference Guide






\usepackage{tikz}
\usepackage{xcolor}
\newcommand{\mycbox}[1]{\tikz{\path[draw=#1,fill=#1] (0,0) rectangle (2cm,0.3cm);}}


\usepackage{verbatim}
\usepackage{cite}
\usepackage{amsmath}
\usepackage[font=small]{caption}  
\usepackage{subcaption}
\captionsetup{compatibility=false}

\usepackage{array}
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
\newcolumntype{M}[1]{>{\centering\arraybackslash}m{#1}}

\usepackage{listings}
\usepackage{url}
\usepackage{color}
\usepackage{setspace}%使用间距宏包
\usepackage{romannum}
\usepackage{relsize}
\usepackage{upgreek}


\usepackage{calc}
\usepackage[strict]{changepage}

\newlength\mymargin
\setlength{\mymargin}{\marginparwidth+\marginparsep}
\newlength\thewidth
\setlength{\thewidth}{\textwidth +\mymargin}

\newlength\overhang
\setlength{\overhang}{\marginparwidth+\marginparsep}

\newenvironment{fullwidth}{%
  	\begin{adjustwidth*}{}{-\overhang}%
  	}{%
  	\end{adjustwidth*}%
  }

\usepackage{framed}
\newenvironment{myshaded}{%
  	\begin{shaded*}
  }{%
  	\end{shaded*}
  }




\usepackage{longtable}
\usepackage{ulem} 


\usepackage{array}
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}


\usepackage{listings}
\usepackage{color}
 
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
 
\lstdefinestyle{mystyle}{
    %backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    %numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\footnotesize,
	extendedchars=true, 
    breaklines=true,
    breakatwhitespace=true,              
    captionpos=b,                    
    %keepspaces=true,                 
    %numbers=left,                    
    %numbersep=5pt,                  
    %showspaces=false,                
    %showstringspaces=false,
    %showtabs=false,                  
    tabsize=2
}
\lstset{style=mystyle}


\usepackage[pdfpagelabels,bookmarks,hyperindex,hyperfigures]{hyperref}
\hypersetup{hidelinks}

\usepackage{imakeidx}
\makeindex[title={中文索引},intoc,columns=2]
\makeindex[name=en, title={英文索引}, intoc, columns=2]

\makeindex[name=math-zh, title={中文索引}, intoc, columns=2]
\makeindex[name=math-en, title={英文索引}, intoc, columns=2]
\indexsetup{level=\section*,toclevel=section,noclearpage}

\newcommand{\myindex}[2]{\index{#1#2}\index[en]{#2#1}}
\newcommand{\mathindex}[2]{\index{#1#2}\index[en]{#2#1}\index[math-en]{#2#1}\index[math-zh]{#1#2}}


\usepackage{pdfpages}
\usepackage{enumerate}
\usepackage{relsize}
\usepackage{upgreek}
\usepackage{mathrsfs}
\usepackage{dsfont}

\usepackage{arydshln}
\usepackage{mathtools}
\delimitershortfall=0pt
\setlength{\dashlinegap}{2pt}

\usepackage{lscape}



%添加‘算法’float
\usepackage{float}


\usepackage[ruled,vlined]{algorithm2e}
\SetAlgorithmName{算法}{算法列表}
\SetAlCapFnt{\footnotesize}
\SetAlCapNameFnt{\footnotesize}


\makeatletter
\renewcommand*\env@matrix[1][*\c@MaxMatrixCols c]{%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{#1}}
\makeatother

%列表缩进%
\usepackage{enumitem}
\setlist[itemize,1]{leftmargin=\dimexpr 32pt}
\setlist[enumerate,1]{leftmargin=\dimexpr 32pt}



%段间距，留到正式版%
\setlength{\parskip}{0.2\baselineskip}

%用于去掉章节在目录中的点线
\usepackage{tocloft}

\usepackage[labelfont=bf]{caption}

\renewcommand{\arraystretch}{1.5}


\titleformat*{\subsection}{\large\bfseries\fontfamily{Times New Roman}}
\titleformat*{\paragraph}{\normalsize\bfseries\fontfamily{Times New Roman}}




\usepackage[framemethod=TikZ]{mdframed}
\newcounter{revision}[section]
\newenvironment{revision}[5][]{%
\refstepcounter{revision}%
\ifstrempty{#1}%
{\mdfsetup{%
frametitle={%
\tikz[baseline=(current bounding box.east),outer sep=0pt]
\node[anchor=east,rectangle,fill=blue!20]
{\strut 修订~\therevision:~#1: #2};}}
}%
{\mdfsetup{%
frametitle={%
\tikz[baseline=(current bounding box.east),outer sep=0pt]
\node[anchor=east,rectangle,fill=blue!20]
{\strut 修订~\therevision:~#1: #2};}}%
}%
\mdfsetup{innertopmargin=10pt,linecolor=blue!20,%
linewidth=2pt,topline=true,%
frametitleaboveskip=\dimexpr-\ht\strutbox\relax
}
\vspace{0.5cm}
\begin{mdframed}[]\relax%
\textbf{类型}：#3\\
\textbf{读者}：#4\\
\textbf{地址}：#5\\
\textbf{问题简述}：
}{\end{mdframed}}








\begin{document}
\dominitoc
%\includepdf[pages={1,{}},width=190mm]{figures/Cover-front}

\thispagestyle{empty}

\begin{fullwidth}
\begin{center}
{\scshape\LARGE $  $ \par}
\vspace{4.0cm}
{\Huge\bfseries 全局光照技术：从离线到实时渲染\\}

\vspace{2.0cm}
{\Large 秦春林$  $著}\\[5pt]

\vfill
\includegraphics[width=0.6\textwidth]{figures/pub-logo}
\end{center}
\end{fullwidth}
%\end{titlepage}



\begin{fullwidth}
\includepdf[pages={-}]{figures/copyright}
\end{fullwidth}
\clearpage


\frontmatter
\pagenumbering{roman}
\setcounter{page}{-1}


%\begin{comment}

\include{templates/dedic}
\include{templates/preface}

\setcounter{tocdepth}{2}
\renewcommand*\contentsname{目~~录}
\tableofcontents
\clearpage

%\end{comment}


\mainmatter
\input{chapters/chapters}

%\input{templates/revision}



\backmatter




\newgeometry{centering,paperwidth=190mm,paperheight=240mm,left=22mm,top=24mm,marginparsep=0mm,marginparwidth=0mm,textwidth=153mm,height=200mm}
\setboolean{@twoside}{true} 


%\printbibliography
\bibliographystyle{apalike}
\bibliography{thebook}
\addcontentsline{toc}{chapter}{参~考~文~献}\mtcaddchapter 


%\begin{comment}

\small
\extrachap{专有名词索引}
\addcontentsline{toc}{chapter}{专有名词索引}\mtcaddchapter 

\printindex
\newpage
\printindex[en]


%\end{comment}

\pagestyle{empty}


%\includepdf[pages={{1-2}},width=190mm]{figures/Cover-end}
\end{document}